<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		.main {
			min-height: 60vh;
		}

		.img-container {
			height: 340px;
			border: 2px dashed #ccc;
			display: flex;
			align-items: center;
			justify-content: center;
			position: relative;
			border-radius: 50%;
			overflow: hidden;
		}

		.img-container img {
			max-width: 100%;
			max-height: 100%;
			object-fit: cover;
		}

		.img-container img.loaded {
			display: block;
		}
	</style>
	<link rel="stylesheet" href="OrdersStyles.css">
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
	<script src="https://kit.fontawesome.com/4287c80df9.js" crossorigin="anonymous"></script>

	<!--Google Font : Nunito-->
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600&display=swap" rel="stylesheet">

	<!-- For style(All CSS content) -->
	<link rel="stylesheet" type="text/css" href="../styles/home.css" />
	<link rel="stylesheet" type="text/css" href="../styles/footer.css" />
	<link rel="stylesheet" type="text/css" href="../styles/navbar.css" />
	<link rel="icon" href="images/favicon.ico">

	<!-- JS Bundle for BS  -->
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
		integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous">
		</script>
	<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
	<title>新增會員</title>
</head>

<body>

	<div class="container-fluid" style="margin-top: 100px;">
		<section id="banner" style="background: #FAF8EC;">
			<div class="container">
						<div class="swiper-slide pt-5 pb-2 swiper-slide-active" role="group" aria-label="1 / 3"
							style="width: 1300px;">
							<h2 class="text-center" style="font-weight: bold">新增會員</h2>
						</div>
			</div>
		</section>
	</div>


	<section class="section profile">
		<div class="row" >
			<div class="col-xl-2">


			</div>

			<div class="col-xl-8">

				<div class="card">
					<div class="card-body pt-2">
						<!-- Bordered Tabs -->

						<div class="tab-content">


							<!-- Profile Edit Form -->
							<form id="myForm" method="post" action="/Register" enctype="multipart/form-data">

								<div class="row mb-3">
									<label for="fileInput"
										class="custom-file-button col-md-4 col-lg-3 col-form-label text-dark"
										style="font-size: 1.4rem !important;font-weight: bold;">選擇照片</label>
									<input type="file" name="picture" id="fileInput" onchange="display()"
										style="display: none">
									<div class="img img-container col-md-5 col-lg-4" style="padding: 0;"
										onclick="fileUpdate()">
										<img class="imgInput img-fluid w-100" id="profileImage">
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-md-6">
										<div class="row">
											<label for="userNameU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">姓名:</label>
											<div class="col-md-8 col-lg-9">
												<input name="userName" type="text" class="form-control" id="userNameU"
													value="" required>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<label for="nickNameU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">暱名:</label>
											<div class="col-md-8 col-lg-9">
												<input name="nickName" type="text" class="form-control" id="nickNameU"
													value="" required>
											</div>
										</div>
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-md-6">
										<div class="row">
											<label for="gender" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">性別:</label>
											<div class="col-md-8 col-lg-9">
												<select name="gender" class="form-select" id="genderU">
													<option value="男">男</option>
													<option value="女">女</option>
												</select>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<label for="emailU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">信箱:</label>
											<div class="col-md-8 col-lg-9">
												<input name="email" type="text" class="form-control" id="emailU"
													value="" required>
												<div id="emailMessage" class="text-danger mt-2"></div>
											</div>
										</div>
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-md-6">
										<div class="row">
											<label for="currentPassword"
												class="ps-2 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">目前密碼:</label>
											<div class="col-md-8 col-lg-9">
												<input name="password" type="password" class="form-control"
													id="currentPassword">
												<div id="passwordMessage" class="text-danger mt-2"></div>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<label for="renewPassword"
												class="ps-2 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">確認密碼:</label>
											<div class="col-md-8 col-lg-9">
												<input name="renewpassword" type="password" class="form-control"
													id="renewPassword">
												<div id="newPasswordMessage" class="text-danger mt-2"></div>
											</div>
										</div>
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-md-6">
										<div class="row">
											<label for="birthdayU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">生日:</label>
											<div class="col-md-8 col-lg-9">
												<input name="birthday" type="date" class="form-control" id="birthdayU"
													value="" required>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<label for="phoneU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">電話:</label>
											<div class="col-md-8 col-lg-9">
												<input name="phone" type="text" class="form-control" id="phoneU"
													value="" required>
											</div>
										</div>
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-md-6">
										<div class="row">
											<label for="addressU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">地址:</label>
											<div class="col-md-8 col-lg-9">
												<input name="address" type="text" class="form-control" id="addressU"
													value="" required>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<label for="danceCharacterU"
												class="ps-2 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">跳舞角色:</label>
											<div class="col-md-8 col-lg-9">
												<select name="danceCharacter" type="text" class="form-control"
													id="danceCharacterU">
													<option value="">請選擇角色</option>
													<option value="leader">Leader</option>
													<option value="follower">Follower</option>
												</select>
											</div>
										</div>
									</div>
								</div>

								<div class="row mb-3">
									<div class="col-md-6">
										<div class="row">
											<label for="danceAgeU" class="ps-4 col-md-4 col-lg-3 col-form-label text-dark"
												style="font-size: 1.4rem !important;font-weight: bold;">舞齡:</label>
											<div class="col-md-8 col-lg-9">
												<input name="danceAge" type="number" class="form-control" id="danceAgeU"
													min="1" max="50" value="">
											</div>
										</div>
									</div>
									<!-- Add any additional fields in the second column if needed -->
								</div>

								<div class="d-flex align-items-center justify-content-between ">
									<button type="submit" class="btn btn-primary register mx-5">儲存</button>
									<button type="button" onclick="onePiceN()"
										class="onePice btn btn-primary mx-5">一鍵輸入</button>
								</div>
							</form><!-- End Profile Edit Form -->


						</div><!-- End Bordered Tabs -->
					</div>
				</div>
			</div>
		</div>

	</section>



	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous">
		</script>
	<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script>
		fetch('../basic.html')
			.then(response => response.text())
			.then(html => {
				document.body.innerHTML += html;
				console.log("你到底有沒有近來");
				$('#memberDropdown').attr("style", "display: none");
				$('#loginButton').attr("style", "display: block");
			});

		function onePiceN() {
			$('#userNameU').val('鄭廷耀');
			$('#nickNameU').val('耀');
			$('#emailU').val('mhou6vm0@gmail.com').trigger('input');;
			$('#currentPassword').val('123456');
			$('#renewPassword').val('123456').trigger('input');
			$('#birthdayU').val('1995-02-11');
			$('#phoneU').val('0976163963');
			$('#addressU').val('桃園市楊梅區');
			$('#phoneU').val('0976163963');
			$('#danceCharacterU').prop('selectedIndex', 2);
			$('#danceAgeU').val('3');


		}


		$('.register').click(function (e) {
			e.preventDefault(); // 阻止直接提交表單

			if (checkdata() && isEmailValid) {
				Swal.fire({
					position: "center",
					icon: "success",
					title: "送出確定",
					showConfirmButton: false,
					timer: 1500,
					willClose: () => {
						$('#myForm').submit(); // 關閉後 提交表單

					}
				});
			} else {
				// 沒填寫完
				Swal.fire({
					icon: 'error',
					title: '請填寫所有必填欄位'
				});
			}
		})


		function checkdata() {
			let required = $('input[required]');

			for (let i = 0; i < required.length; i++) {
				if (!required[i].value) {
					return false;
				}

			}

			return true;
		}

		let isCurrentPasswordValid = false;
		let isNewPasswordValid = false;
		let isEmailValid = false;

		//判定資料庫信箱有沒有重複
		$(document).on('input', '#emailU', function () {
			var email = $(this).val();
			console.log(email);
			$.ajax({
				url: '/validateEmail',
				type: 'POST',
				data: {email: email},
				success: function () {
					$('#emailMessage').text('信箱可以使用').removeClass('text-danger').addClass('text-success');
					isEmailValid = true;
				},
				error: function () {
					$('#emailMessage').text('信箱已申請').removeClass('text-success').addClass('text-danger');
					isEmailValid = false;
				}
			});
		});
		$(document).on('input', '#renewPassword', function () {
			var renewPassword = $(this).val();
			var currentPassword = $('#currentPassword').val();
			if (renewPassword === currentPassword) {
				$('#newPasswordMessage').text('正確').removeClass('text-danger').addClass('text-success');
				isNewPasswordValid = true;

			} else {
				$('#newPasswordMessage').text('請重新輸入').removeClass('text-success').addClass('text-danger');
				isNewPasswordValid = false;
			}

		});



		function display() {
			let fileInput = $('#fileInput');
			let img = $('.imgInput');

			if (fileInput[0].files && fileInput[0].files[0]) {
				let reader = new FileReader();
				reader.onload = function (e) {
					img.attr('src', e.target.result);
					img.addClass('loaded'); // 添加 'loaded' 類
				};
				reader.readAsDataURL(fileInput[0].files[0]);
			}
		}


		function fileUpdate() {
			document.getElementById('fileInput').click();
		}

	</script>
</body>

</html>